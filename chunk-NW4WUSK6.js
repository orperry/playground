import{Aa as C,Ba as g,Ca as x,Da as d,Ea as p,Fa as k,Ga as j,Ha as B,Ia as I,J as P,Ja as b,Ka as q,La as A,Ma as y,Na as R,Oa as T,Pa as D,Qa as _,Ra as m,S as M,Sa as f,T as $,a as F,b as w,bb as E,cb as N,db as L,eb as U,i as h,ia as u,ma as O,qa as z,za as S}from"./chunk-TIAHHHKX.js";var v=class s{productColumns=new h([]);productColumns$=this.productColumns.asObservable();productRows=new h([]);productRows$=this.productRows.asObservable();matrix=new h(this.initMatrix());matrix$=this.matrix.asObservable();selectCell(i,e){let r=this.matrix.getValue(),o=r[i][e];o.isSelected=!o.isSelected,this.matrix.next([...r]),this.calculateProducts(r)}initMatrix(){let i=this.initNumbersArrays(),e=this.initMaskArrays(),r=i.map((o,t)=>o.map((n,a)=>w(F({},n),{isUsed:e[t][a]})));return console.log(r),this.calculateProducts(r),r}initNumbersArrays(){return Array.from({length:5},()=>Array.from({length:5},()=>({value:Math.floor(Math.random()*8)+2,isUsed:!1,isSelected:!1})))}initMaskArrays(){let e=Array.from({length:5},()=>Array(5).fill(!1)),r=t=>e[t].filter(n=>n).length,o=t=>e.map(n=>n[t]).filter(n=>n).length;for(let t=0;t<5;t++){let n=Math.floor(Math.random()*2)+2,a=0;for(;a<n;){let c=Math.floor(Math.random()*5);!e[t][c]&&o(c)<4&&(e[t][c]=!0,a++)}}for(let t=0;t<5;t++){let n=o(t);if(n<2){let a=0;for(let c=0;c<5&&a<2-n;c++)!e[c][t]&&r(c)<4&&(e[c][t]=!0,a++)}}return e}calculateProducts(i){let r=[],o=[];for(let t=0;t<5;t++){let n=1,a=1;for(let l=0;l<5;l++)i[t][l].isUsed&&(n*=i[t][l].value),i[t][l].isSelected&&(a*=i[t][l].value);let c=a>1&&a===n;r.push({product:n,isMatched:c})}for(let t=0;t<5;t++){let n=1,a=1;for(let l=0;l<5;l++)i[l][t].isUsed&&(n*=i[l][t].value),i[l][t].isSelected&&(a*=i[l][t].value);let c=a>1&&a===n;o.push({product:n,isMatched:c})}this.productRows.next(r),this.productColumns.next(o)}static \u0275fac=function(e){return new(e||s)};static \u0275prov=P({token:s,factory:s.\u0275fac})};var G=s=>({matched:s}),K=s=>({selected:s});function Q(s,i){if(s&1){let e=j();d(0,"div",6),B("click",function(){let o=M(e).$index,t=I().$index,n=I();return $(n.selectCell(t,o))}),b(1),p()}if(s&2){let e=i.$implicit;x("ngClass",_(2,K,e.isSelected)),u(),A(" ",e.value," ")}}function W(s,i){if(s&1&&(d(0,"div",1),C(1,Q,2,4,"div",4,S),d(3,"div",5),b(4),m(5,"number"),p()()),s&2){let e=i.$implicit,r=i.$index;I();let o=T(4);u(),g(e),u(2),x("ngClass",_(4,G,o==null||o[r]==null?null:o[r].isMatched)),u(),q(f(5,2,o==null||o[r]==null?null:o[r].product))}}function X(s,i){if(s&1&&(d(0,"div",2),b(1),m(2,"number"),p()),s&2){let e=i.$implicit;x("ngClass",_(4,G,e==null?null:e.isMatched)),u(),q(f(2,2,e.product))}}var V=class s{constructor(i){this.fiveInSquareService=i}matrix$;productColumns$;productRows$;ngOnInit(){this.matrix$=this.fiveInSquareService.matrix$,this.productColumns$=this.fiveInSquareService.productColumns$,this.productRows$=this.fiveInSquareService.productRows$}selectCell(i,e){this.fiveInSquareService.selectCell(i,e)}static \u0275fac=function(e){return new(e||s)(O(v))};static \u0275cmp=z({type:s,selectors:[["app-five-in-square"]],features:[D([v])],decls:14,vars:7,consts:[[1,"square"],[1,"square-row"],[1,"square-item","col-product",3,"ngClass"],[1,"square-item","col-product"],[1,"square-item",3,"ngClass"],[1,"square-item","row-product",3,"ngClass"],[1,"square-item",3,"click","ngClass"]],template:function(e,r){if(e&1&&(d(0,"h1"),b(1,"Five in a Square"),p(),y(2),m(3,"async"),y(4),m(5,"async"),d(6,"div",0),C(7,W,6,6,"div",1,S),d(9,"div",1),C(10,X,3,6,"div",2,S),m(12,"async"),k(13,"div",3),p()()),e&2){let o=f(3,0,r.matrix$);u(4),R(f(5,2,r.productRows$)),u(3),g(o),u(3),g(f(12,5,r.productColumns$))}},dependencies:[U,E,N,L],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;gap:20px;justify-content:flex-start;align-items:center;height:100%;width:100%;font-family:Alan Sans,sans-serif;font-optical-sizing:auto;font-weight:500;font-style:normal;font-size:x-large}.square[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;border-left:1px solid #fff;border-top:1px solid #fff}.square-row[_ngcontent-%COMP%]{display:flex;flex-direction:row}.square-item[_ngcontent-%COMP%]{width:60px;height:60px;display:flex;justify-content:center;align-items:center;border-right:3px solid #fff;border-bottom:3px solid #fff;background-color:#7fffd4}.col-product[_ngcontent-%COMP%]{color:#999;background-color:unset;border-right:3px solid #fff;border-bottom:unset;font-size:large}.row-product[_ngcontent-%COMP%]{color:#999;background-color:unset;border-right:unset;border-bottom:3px solid #fff;border-top:unset;font-size:large}.selected[_ngcontent-%COMP%]{background-color:orange}.matched[_ngcontent-%COMP%]{color:green}"]})};export{V as FiveInSquareComponent};
