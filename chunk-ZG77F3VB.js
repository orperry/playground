import{Aa as x,Ba as I,Ca as b,Da as p,Ea as v,Fa as B,Ga as j,Ha as W,Ia as y,J as M,Ja as h,Ka as _,La as q,Ma as w,Na as R,Oa as A,Pa as T,Qa as S,Ra as d,S as P,Sa as m,T as O,a as $,b as F,bb as E,cb as V,db as D,eb as N,i as f,ia as u,ma as k,qa as z,za as g}from"./chunk-TIAHHHKX.js";var C=class s{productColumns=new f([]);productColumns$=this.productColumns.asObservable();productRows=new f([]);productRows$=this.productRows.asObservable();matrix=new f(this.initMatrix());matrix$=this.matrix.asObservable();steps=new f(0);steps$=this.steps.asObservable();isWin=new f(!1);isWin$=this.isWin.asObservable();selectCell(i,t){if(this.isWin.getValue())return;this.steps.next(this.steps.getValue()+1);let n=this.matrix.getValue(),r=n[i][t];r.isSelected=!r.isSelected,this.matrix.next([...n]),this.calculateProducts(n)}initMatrix(){let i=this.initNumbersArrays(),t=this.initMaskArrays(),n=i.map((r,e)=>r.map((o,a)=>F($({},o),{isUsed:t[e][a]})));return this.calculateProducts(n),n}initNumbersArrays(){return Array.from({length:5},()=>Array.from({length:5},()=>({value:Math.floor(Math.random()*8)+2,isUsed:!1,isSelected:!1})))}initMaskArrays(){let t=Array.from({length:5},()=>Array(5).fill(!1)),n=e=>t[e].filter(o=>o).length,r=e=>t.map(o=>o[e]).filter(o=>o).length;for(let e=0;e<5;e++){let o=Math.floor(Math.random()*2)+2,a=0;for(;a<o;){let c=Math.floor(Math.random()*5);!t[e][c]&&r(c)<4&&(t[e][c]=!0,a++)}}for(let e=0;e<5;e++){let o=r(e);if(o<2){let a=0;for(let c=0;c<5&&a<2-o;c++)!t[c][e]&&n(c)<4&&(t[c][e]=!0,a++)}}return t}calculateProducts(i){let n=[],r=[];for(let e=0;e<5;e++){let o=1,a=1;for(let l=0;l<5;l++)i[e][l].isUsed&&(o*=i[e][l].value),i[e][l].isSelected&&(a*=i[e][l].value);let c=a>1&&a===o;n.push({product:o,isMatched:c})}for(let e=0;e<5;e++){let o=1,a=1;for(let l=0;l<5;l++)i[l][e].isUsed&&(o*=i[l][e].value),i[l][e].isSelected&&(a*=i[l][e].value);let c=a>1&&a===o;r.push({product:o,isMatched:c})}this.productRows.next(n),this.productColumns.next(r),this.checkWinCondition(n,r)}checkWinCondition(i,t){let n=i.every(e=>e.isMatched),r=t.every(e=>e.isMatched);n&&r&&this.isWin.next(!0)}static \u0275fac=function(t){return new(t||s)};static \u0275prov=M({token:s,factory:s.\u0275fac})};var L=s=>({won:s}),G=s=>({matched:s}),K=s=>({selected:s});function Q(s,i){if(s&1){let t=j();p(0,"div",7),W("click",function(){let r=P(t).$index,e=y().$index,o=y();return O(o.selectCell(e,r))}),h(1),v()}if(s&2){let t=i.$implicit;b("ngClass",S(2,K,t.isSelected)),u(),q(" ",t.value," ")}}function X(s,i){if(s&1&&(p(0,"div",2),x(1,Q,2,4,"div",5,g),p(3,"div",6),h(4),d(5,"number"),v()()),s&2){let t=i.$implicit,n=i.$index;y();let r=A(5);u(),I(t),u(2),b("ngClass",S(4,G,r==null||r[n]==null?null:r[n].isMatched)),u(),_(m(5,2,r==null||r[n]==null?null:r[n].product))}}function Y(s,i){if(s&1&&(p(0,"div",3),h(1),d(2,"number"),v()),s&2){let t=i.$implicit;b("ngClass",S(4,G,t==null?null:t.isMatched)),u(),_(m(2,2,t.product))}}var U=class s{constructor(i){this.fiveInSquareService=i}matrix$;productColumns$;productRows$;steps$;isWin$;ngOnInit(){this.matrix$=this.fiveInSquareService.matrix$,this.productColumns$=this.fiveInSquareService.productColumns$,this.productRows$=this.fiveInSquareService.productRows$,this.steps$=this.fiveInSquareService.steps$,this.isWin$=this.fiveInSquareService.isWin$}selectCell(i,t){this.fiveInSquareService.selectCell(i,t)}static \u0275fac=function(t){return new(t||s)(k(C))};static \u0275cmp=z({type:s,selectors:[["app-five-in-square"]],features:[T([C])],decls:19,vars:20,consts:[[3,"ngClass"],[1,"square"],[1,"square-row"],[1,"square-item","col-product",3,"ngClass"],[1,"square-item","col-product"],[1,"square-item",3,"ngClass"],[1,"square-item","row-product",3,"ngClass"],[1,"square-item",3,"click","ngClass"]],template:function(t,n){if(t&1&&(p(0,"h1",0),d(1,"async"),h(2,"Five in a Square"),v(),w(3),d(4,"async"),w(5),d(6,"async"),p(7,"div",1),x(8,X,6,6,"div",2,g),p(10,"div",2),x(11,Y,3,6,"div",3,g),d(13,"async"),B(14,"div",4),v()(),p(15,"h3",0),d(16,"async"),h(17),d(18,"async"),v()),t&2){b("ngClass",S(16,L,m(1,3,n.isWin$)));let r=m(4,5,n.matrix$);u(5),R(m(6,7,n.productRows$)),u(3),I(r),u(3),I(m(13,10,n.productColumns$)),u(4),b("ngClass",S(18,L,m(16,12,n.isWin$))),u(2),q("Steps: ",m(18,14,n.steps$))}},dependencies:[N,E,V,D],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;gap:20px;justify-content:flex-start;align-items:center;height:100%;width:100%;font-family:Alan Sans,sans-serif;font-optical-sizing:auto;font-weight:500;font-style:normal;font-size:x-large;background-color:#ffebcd;user-select:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none}.square[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;border-left:1px solid blanchedalmond;border-top:1px solid blanchedalmond}.square-row[_ngcontent-%COMP%]{display:flex;flex-direction:row}.square-item[_ngcontent-%COMP%]{width:60px;height:60px;display:flex;justify-content:center;align-items:center;border-right:3px solid blanchedalmond;border-bottom:3px solid blanchedalmond;background-color:#7fffd4}.col-product[_ngcontent-%COMP%]{color:#999;background-color:unset;border-right:3px solid blanchedalmond;border-bottom:unset;font-size:large}.row-product[_ngcontent-%COMP%]{color:#999;background-color:unset;border-right:unset;border-bottom:3px solid blanchedalmond;border-top:unset;font-size:large}.selected[_ngcontent-%COMP%]{background-color:orange}.matched[_ngcontent-%COMP%]{color:green}.won[_ngcontent-%COMP%]{color:gold;text-shadow:0 0 5px black,0 0 10px black,0 0 20px black}"]})};export{U as FiveInSquareComponent};
